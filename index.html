<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³ ë•ì´ˆ ë‚³ê¸° ê²Œì„</title>
    <link href="https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            background-color: #ADD8E6;
            font-family: 'Silkscreen', 'Malgun Gothic', monospace;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            transition: background-color 0.5s ease;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        .container {
            text-align: center;
        }

        h1 {
            font-family: 'Silkscreen', 'Malgun Gothic', monospace;
            font-weight: bold;
            font-size: 80px;
            color: #FFFFFF;
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            text-shadow:
                4px 0 0 #000000,
                -4px 0 0 #000000,
                0 4px 0 #000000,
                0 -4px 0 #000000,
                4px 4px 0 #000000;
        }

        h1 span {
            display: inline-block;
            margin: 0 10px;
        }

        .word1 {
            animation: moveDown 0.4s cubic-bezier(0.45, 0, 0.55, 1) infinite;
        }

        .word2 {
            animation: moveUp 0.4s cubic-bezier(0.45, 0, 0.55, 1) infinite;
        }

        .word3 {
            animation: moveDown 0.4s cubic-bezier(0.45, 0, 0.55, 1) infinite;
        }

        @keyframes moveDown {
            0%, 35% {
                transform: translateY(0);
            }
            40%, 60% {
                transform: translateY(15px);
            }
            65%, 100% {
                transform: translateY(0);
            }
        }

        @keyframes moveUp {
            0%, 35% {
                transform: translateY(0);
            }
            40%, 60% {
                transform: translateY(-15px);
            }
            65%, 100% {
                transform: translateY(0);
            }
        }

        .button-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
        }

        button {
            font-family: 'Silkscreen', 'Malgun Gothic', monospace;
            font-weight: bold;
            width: 250px;
            padding: 20px 40px;
            font-size: 20px;
            background-color: #FFFFFF;
            color: #000000;
            border: 4px solid #000000;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 4px 4px 0 #000000;
        }

        button:hover {
            background-color: #FFE066;
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 #000000;
        }

        button:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000000;
        }

        /* ê²Œì„ í™”ë©´ */
        #gameScreen {
            display: none;
            width: 100%;
            height: 100vh;
            position: relative;
        }

        #gameScreen.active {
            display: block;
        }

        .game-title {
            font-family: 'Silkscreen', 'Malgun Gothic', monospace;
            font-weight: bold;
            font-size: 48px;
            color: #FFFFFF;
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            text-align: center;
            text-shadow:
                3px 0 0 #000000,
                -3px 0 0 #000000,
                0 3px 0 #000000,
                0 -3px 0 #000000,
                3px 3px 0 #000000;
            display: flex;
            justify-content: center;
            gap: 40px;
        }

        .game-title span {
            display: inline-block;
            min-width: 200px;
            text-align: center;
        }

        .arrow-buttons {
            position: absolute;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .arrow-btn {
            width: 80px;
            height: 80px;
            font-size: 40px;
            background-color: #FFFFFF;
            color: #000000;
            border: 4px solid #000000;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 4px 4px 0 #000000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .arrow-btn:hover {
            background-color: #FFE066;
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 #000000;
        }

        .arrow-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000000;
        }

        .game-boxes {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }

        .game-box {
            width: 100px;
            height: 100px;
            background-color: #FFFFFF;
            border: 3px solid #000000;
            border-radius: 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.1s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-box.active {
            border: 6px solid #FF0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
            transform: scale(1.1);
        }

        .arrow-icon {
            opacity: 0;
            transform: scale(0);
            transition: all 0.2s ease;
            width: 60px;
            height: 60px;
        }

        .arrow-icon.show {
            opacity: 1;
            transform: scale(1);
        }

        .arrow-icon svg {
            width: 100%;
            height: 100%;
            fill: #555555;
            transition: transform 0.2s ease;
        }

        .arrow-icon.up svg {
            transform: rotate(0deg);
        }

        .arrow-icon.down svg {
            transform: rotate(180deg);
        }

        /* O í‘œì‹œ */
        #okaySign {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-family: 'Malgun Gothic', sans-serif;
            font-weight: bold;
            font-size: 300px;
            color: rgba(91, 97, 91, 0.644);
            z-index: 1500;
            opacity: 0;
            pointer-events: none;
        }

        #okaySign.show {
            animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        #okaySign.hide {
            animation: bounceOut 0.3s ease-in forwards;
        }

        @keyframes bounceIn {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        @keyframes bounceOut {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
        }

        /* ì•„ê¸° ì´ë¯¸ì§€ */
        #babyImage {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            pointer-events: none;
            z-index: 500;
            opacity: 0;
            visibility: hidden;
        }

        #babyImage.show {
            visibility: visible;
        }

        #babyImage.fall {
            animation: fallDown 0.5s ease-in forwards;
        }

        #babyImage.rise {
            animation: riseUp 0.5s ease-out forwards;
        }

        @keyframes fallDown {
            0% {
                top: 50%;
                opacity: 1;
            }
            100% {
                top: 120%;
                opacity: 0;
            }
        }

        @keyframes riseUp {
            0% {
                top: 120%;
                opacity: 0;
            }
            100% {
                top: 50%;
                opacity: 1;
            }
        }

        /* ì‚¬ëŒ ì´ë¯¸ì§€ */
        .people-image {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 450px;
            height: auto;
            pointer-events: none;
            z-index: 400;
            transform-origin: center bottom;
            animation: kneeSquat 0.4s ease-in-out infinite;
        }

        @keyframes kneeSquat {
            0%, 100% {
                transform: translate(-50%, -50%) scaleY(1);
            }
            50% {
                transform: translate(-50%, -50%) scaleY(0.9);
            }
        }

        /* ì¹´ìš´íŠ¸ë‹¤ìš´ ì˜¤ë²„ë ˆì´ */
        #countdownOverlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        #countdownOverlay.active {
            display: flex;
        }

        .countdown-number {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            font-size: 200px;
            color: rgba(255, 255, 255, 0.7);
            -webkit-text-stroke: 5px rgba(0, 0, 0, 0.7);
            text-stroke: 5px rgba(0, 0, 0, 0.7);
            text-shadow:
                5px 5px 0 rgba(0, 0, 0, 0.7),
                10px 10px 0 rgba(0, 0, 0, 0.7);
            animation: countdownBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes countdownBounce {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* ê²Œì„ ì˜¤ë²„ ì˜¤ë²„ë ˆì´ */
        #gameOverOverlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 40px;
        }

        #gameOverOverlay.active {
            display: flex;
        }

        .gameover-text {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            font-size: 80px;
            color: #FF0000;
            -webkit-text-stroke: 3px #FFFFFF;
            text-stroke: 3px #FFFFFF;
            text-shadow:
                3px 3px 0 #FFFFFF,
                6px 6px 0 #000000;
        }

        .menu-button {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            width: 300px;
            padding: 20px 40px;
            font-size: 28px;
            background-color: #FFFFFF;
            color: #000000;
            border: 3px solid #000000;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .menu-button:hover {
            background-color: #F0F0F0;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
        }

        .menu-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* ê²Œì„ ë°©ë²• íŒì—… */
        #howToPlayPopup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }

        #howToPlayPopup.active {
            display: flex;
        }

        .popup-content {
            background-color: #FFFFFF;
            width: 700px;
            max-width: 90%;
            max-height: 80vh;
            border-radius: 0;
            border: 5px solid #000000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .popup-header {
            background-color: #ADD8E6;
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #000000;
        }

        .popup-title {
            font-family: 'Malgun Gothic', sans-serif;
            font-weight: bold;
            font-size: 36px;
            color: #000000;
        }

        .popup-body {
            padding: 40px;
            overflow-y: auto;
            flex: 1;
        }

        .popup-page {
            display: none;
        }

        .popup-page.active {
            display: block;
        }

        .popup-page h2 {
            font-family: 'Malgun Gothic', sans-serif;
            font-weight: bold;
            font-size: 28px;
            color: #000000;
            margin-bottom: 20px;
        }

        .popup-page p {
            font-family: 'Malgun Gothic', sans-serif;
            font-size: 18px;
            line-height: 1.8;
            color: #333333;
            margin-bottom: 15px;
        }

        .popup-page ul {
            font-family: 'Malgun Gothic', sans-serif;
            font-size: 18px;
            line-height: 2;
            color: #333333;
            margin-left: 20px;
        }

        .popup-page .highlight {
            background-color: #FFE066;
            padding: 2px 6px;
            border-radius: 0;
            font-weight: bold;
        }

        .popup-footer {
            background-color: #F0F0F0;
            padding: 20px;
            border-top: 3px solid #000000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .popup-nav-button {
            font-family: 'Malgun Gothic', sans-serif;
            font-weight: bold;
            padding: 12px 30px;
            font-size: 18px;
            background-color: #FFFFFF;
            color: #000000;
            border: 3px solid #000000;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .popup-nav-button:hover {
            background-color: #ADD8E6;
            transform: scale(1.05);
        }

        .popup-nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .popup-page-indicator {
            font-family: 'Malgun Gothic', sans-serif;
            font-size: 16px;
            color: #666666;
        }

        .popup-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background-color: #FF0000;
            color: #FFFFFF;
            border: 3px solid #000000;
            border-radius: 0;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .popup-close:hover {
            background-color: #CC0000;
            transform: scale(1.1);
        }

        /* í¬ë ˆë”§ */
        .credit {
            position: fixed;
            bottom: 10px;
            font-family: 'Malgun Gothic', sans-serif;
            font-size: 18px;
            font-weight: bold;
            color: #333333;
            z-index: 100;
        }

        .credit-left {
            left: 15px;
        }

        .credit-right {
            right: 15px;
        }
    </style>
</head>
<body>
    <!-- Credits -->
    <div class="credit credit-left">ì‚¬ìš´ë“œì œê³µ:ìœ íŠœë²„ í–‰ë³µí•œí”¼ìë¹µë‹˜(ì°ìœ¼ë¡œ í—ˆë½ ë°›ìŒ)</div>
    <div class="credit credit-right">MADE BY YOUNGJIN</div>

    <audio id="bgMusic" loop>
        <source src="assets/main.mp3" type="audio/mpeg">
    </audio>

    <audio id="inGameMusic" loop>
        <source src="assets/inGame.mp3" type="audio/mpeg">
    </audio>

    <audio id="hoSound">
        <source src="assets/ho.mp3" type="audio/mpeg">
    </audio>

    <audio id="jjaSound">
        <source src="assets/jja.mp3" type="audio/mpeg">
    </audio>

    <audio id="okaySound">
        <source src="assets/okay.mp3" type="audio/mpeg">
    </audio>

    <!-- ë©”ì¸ í™”ë©´ -->
    <div class="container" id="mainScreen">
        <!-- ì‚¬ëŒ ì´ë¯¸ì§€ -->
        <img class="people-image" src="assets/people1.png" alt="people">

        <h1>
            <span class="word1">ê³ ë•ì´ˆ</span>
            <span class="word2">ë‚³ê¸°</span>
            <span class="word3">ê²Œì„</span>
        </h1>
        <div class="button-container">
            <button id="startGame">ê²Œì„ ì‹œì‘</button>
            <button id="howToPlay">ê²Œì„ ë°©ë²•</button>
        </div>
    </div>

    <!-- ê²Œì„ í™”ë©´ -->
    <div id="gameScreen">
        <div class="game-title" id="gameTitle">
            <span id="word1">-</span>
            <span id="word2">-</span>
            <span id="word3">-</span>
            <span id="word4">-</span>
        </div>

        <div class="arrow-buttons">
            <button class="arrow-btn" id="upBtn">â–²</button>
            <button class="arrow-btn" id="downBtn">â–¼</button>
        </div>

        <!-- ì‚¬ëŒ ì´ë¯¸ì§€ -->
        <img class="people-image" src="assets/people1.png" alt="people">

        <!-- ì•„ê¸° ì´ë¯¸ì§€ -->
        <img id="babyImage" src="assets/baby.png" alt="baby">

        <!-- O í‘œì‹œ -->
        <div id="okaySign">O</div>

        <div class="game-boxes">
            <div class="game-box">
                <div class="arrow-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 4l-8 8h6v8h4v-8h6z"/>
                    </svg>
                </div>
            </div>
            <div class="game-box">
                <div class="arrow-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 4l-8 8h6v8h4v-8h6z"/>
                    </svg>
                </div>
            </div>
            <div class="game-box">
                <div class="arrow-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 4l-8 8h6v8h4v-8h6z"/>
                    </svg>
                </div>
            </div>
            <div class="game-box">
                <div class="arrow-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 4l-8 8h6v8h4v-8h6z"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ì¹´ìš´íŠ¸ë‹¤ìš´ ì˜¤ë²„ë ˆì´ -->
        <div id="countdownOverlay">
            <div class="countdown-number" id="countdownNumber">3</div>
        </div>

        <!-- ê²Œì„ ì˜¤ë²„ ì˜¤ë²„ë ˆì´ -->
        <div id="gameOverOverlay">
            <div class="gameover-text">í‹€ë ¸ìŠµë‹ˆë‹¤</div>
            <button class="menu-button" id="restartGame">ë‹¤ì‹œ ì‹œì‘ (R)</button>
            <button class="menu-button" id="backToMenu">ë©”ì¸ ë©”ë‰´ (M)</button>
        </div>
    </div>

    <!-- ê²Œì„ ë°©ë²• íŒì—… -->
    <div id="howToPlayPopup">
        <div class="popup-content">
            <button class="popup-close" id="closePopup">Ã—</button>

            <div class="popup-header">
                <div class="popup-title">ê²Œì„ ë°©ë²•</div>
            </div>

            <div class="popup-body">
                <!-- í˜ì´ì§€ 1: ê²Œì„ ì†Œê°œ -->
                <div class="popup-page active" data-page="1">
                    <h2>ğŸ® ê²Œì„ ì†Œê°œ</h2>
                    <p><span class="highlight">ê³ ë•ì´ˆ ë‚³ê¸° ê²Œì„</span>ì€ ë¦¬ë“¬ì— ë§ì¶° ì˜¬ë°”ë¥¸ íƒ€ì´ë°ì— í™”ì‚´í‘œ í‚¤ë¥¼ ëˆ„ë¥´ëŠ” ë¦¬ë“¬ ê²Œì„ì…ë‹ˆë‹¤!</p>
                    <p>í™”ë©´ ìƒë‹¨ì— ë‚˜íƒ€ë‚˜ëŠ” ë‹¨ì–´ë¥¼ ë³´ê³ , ë°•ìŠ¤ê°€ ê°•ì¡°ë  ë•Œ ì •í™•í•œ ì…ë ¥ì„ í•´ì•¼ í•©ë‹ˆë‹¤.</p>
                    <p>ë°•ìëŠ” <span class="highlight">150 BPM</span> (400ms ê°„ê²©)ìœ¼ë¡œ ì§„í–‰ë˜ë©°, ë¼ìš´ë“œê°€ ì§„í–‰ë ìˆ˜ë¡ ë‚œì´ë„ê°€ ë†’ì•„ì§‘ë‹ˆë‹¤.</p>
                </div>

                <!-- í˜ì´ì§€ 2: ì¡°ì‘ ë°©ë²• -->
                <div class="popup-page" data-page="2">
                    <h2>âŒ¨ï¸ ì¡°ì‘ ë°©ë²•</h2>
                    <p><strong>í‚¤ë³´ë“œ ì¡°ì‘:</strong></p>
                    <ul>
                        <li><span class="highlight">â†‘ (ìœ„ í™”ì‚´í‘œ)</span></li>
                        <li><span class="highlight">â†“ (ì•„ë˜ í™”ì‚´í‘œ)</span></li>
                    </ul>
                    <p><strong>í™”ë©´ ë²„íŠ¼:</strong></p>
                    <ul>
                        <li>ì™¼ìª½ì— ìˆëŠ” <span class="highlight">â–²</span>ì™€ <span class="highlight">â–¼</span> ë²„íŠ¼ì„ í´ë¦­í•´ë„ ë©ë‹ˆë‹¤!</li>
                    </ul>
                    <p><strong>ê²Œì„ ì˜¤ë²„ ì‹œ:</strong></p>
                    <ul>
                        <li><span class="highlight">Rí‚¤</span> - ê²Œì„ ë‹¤ì‹œ ì‹œì‘</li>
                        <li><span class="highlight">Mí‚¤</span> - ë©”ì¸ ë©”ë‰´ë¡œ ì´ë™</li>
                    </ul>
                </div>

                <!-- í˜ì´ì§€ 3: ìœ„ í™”ì‚´í‘œ ë‹¨ì–´ -->
                <div class="popup-page" data-page="3">
                    <h2>â¬†ï¸ ìœ„ í™”ì‚´í‘œë¥¼ ëˆŒëŸ¬ì•¼ í•˜ëŠ” ë‹¨ì–´</h2>
                    <p>ë‹¤ìŒ ë‹¨ì–´ê°€ ë‚˜ì˜¤ë©´ ë°•ìŠ¤ê°€ ê°•ì¡°ë  ë•Œ <span class="highlight">ìœ„ í™”ì‚´í‘œ (â†‘)</span>ë¥¼ ëˆ„ë¥´ì„¸ìš”:</p>
                    <ul>
                        <li><span class="highlight">ì§œì‡í˜¸í•´</span></li>
                        <li><span class="highlight">ì…ì¥í•´</span></li>
                        <li><span class="highlight">ë“¤ì–´ê°€</span></li>
                        <li><span class="highlight">ì•„ë¬´ê±°ë‚˜í•´</span> âš ï¸ (ìœ„ ë˜ëŠ” ì•„ë˜ ë‘˜ ë‹¤ ê°€ëŠ¥)</li>
                    </ul>
                </div>

                <!-- í˜ì´ì§€ 4: ì•„ë˜ í™”ì‚´í‘œ & ì…ë ¥ ì•ˆí•¨ -->
                <div class="popup-page" data-page="4">
                    <h2>â¬‡ï¸ ì•„ë˜ í™”ì‚´í‘œ & â›” ì…ë ¥ ì•ˆí•¨</h2>
                    <p><strong>ì•„ë˜ í™”ì‚´í‘œë¥¼ ëˆŒëŸ¬ì•¼ í•˜ëŠ” ë‹¨ì–´:</strong></p>
                    <ul>
                        <li><span class="highlight">ë‚³ì•„</span></li>
                        <li><span class="highlight">í‡´ì¥í•´</span></li>
                        <li><span class="highlight">í˜¸ì‡ì§œí•´</span></li>
                        <li><span class="highlight">ì•„ë¬´ê±°ë‚˜í•´</span> âš ï¸ (ìœ„ ë˜ëŠ” ì•„ë˜ ë‘˜ ë‹¤ ê°€ëŠ¥)</li>
                    </ul>
                    <p><strong>ì•„ë¬´ê²ƒë„ ëˆ„ë¥´ë©´ ì•ˆ ë˜ëŠ” ë‹¨ì–´:</strong></p>
                    <ul>
                        <li><span class="highlight">ë‚³ì§€ë§ˆ</span> - ì…ë ¥í•˜ë©´ í‹€ë¦¼!</li>
                        <li><span class="highlight">ë“¤ì–´ê°€ì§€ë§ˆ</span> - ì…ë ¥í•˜ë©´ í‹€ë¦¼!</li>
                        <li><span class="highlight">-</span> (ë¹ˆì¹¸) - ì…ë ¥í•˜ë©´ í‹€ë¦¼!</li>
                    </ul>
                </div>

                <!-- í˜ì´ì§€ 5: ë‚œì´ë„ ì‹œìŠ¤í…œ -->
                <div class="popup-page" data-page="5">
                    <h2>ğŸ“ˆ ë‚œì´ë„ ì‹œìŠ¤í…œ</h2>
                    <p>ë¼ìš´ë“œê°€ ì§„í–‰ë ìˆ˜ë¡ ë‚œì´ë„ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤!</p>
                    <p><strong>ë¼ìš´ë“œ 1-2 (ì‰¬ì›€):</strong></p>
                    <ul>
                        <li>ë‚³ì•„, ë“¤ì–´ê°€ ë‹¨ì–´ë§Œ ë“±ì¥</li>
                        <li>1~3ê°œ ëœë¤ ë°°ì¹˜</li>
                    </ul>
                    <p><strong>ë¼ìš´ë“œ 3-6 (ì¤‘ê°„):</strong></p>
                    <ul>
                        <li>ë‚³ì•„, ë“¤ì–´ê°€, ë‚³ì§€ë§ˆ, ë“¤ì–´ê°€ì§€ë§ˆ ë“±ì¥</li>
                        <li>1~3ê°œ ëœë¤ ë°°ì¹˜</li>
                    </ul>
                    <p><strong>ë¼ìš´ë“œ 7-9 (ì–´ë ¤ì›€):</strong></p>
                    <ul>
                        <li>ëª¨ë“  ë‹¨ì–´ ë“±ì¥! (í˜¸ì‡ì§œí•´, ì§œì‡í˜¸í•´, ì•„ë¬´ê±°ë‚˜í•´, ì…ì¥í•´, í‡´ì¥í•´ ë“±)</li>
                        <li>1~3ê°œ ëœë¤ ë°°ì¹˜</li>
                    </ul>
                    <p><strong>ë¼ìš´ë“œ 10+ (ë§¤ìš° ì–´ë ¤ì›€):</strong></p>
                    <ul>
                        <li>í—·ê°ˆë¦¬ëŠ” ë‹¨ì–´ë“¤ ìœ„ì£¼ë¡œ ë“±ì¥!</li>
                        <li><span class="highlight">ë¬´ì¡°ê±´ 3ê°œ ë°°ì¹˜</span> - ë¹ˆì¹¸ ì—†ìŒ!</li>
                        <li>ë°°ê²½ìƒ‰ì´ ì—°í•œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ë³€í•¨</li>
                    </ul>
                </div>
            </div>

            <div class="popup-footer">
                <button class="popup-nav-button" id="prevPage">â—€ ì´ì „</button>
                <div class="popup-page-indicator">
                    <span id="currentPage">1</span> / <span id="totalPages">5</span>
                </div>
                <button class="popup-nav-button" id="nextPage">ë‹¤ìŒ â–¶</button>
            </div>
        </div>
    </div>

    <script>
        const bgMusic = document.getElementById('bgMusic');
        const inGameMusic = document.getElementById('inGameMusic');
        const hoSound = document.getElementById('hoSound');
        const jjaSound = document.getElementById('jjaSound');
        const okaySound = document.getElementById('okaySound');
        let isGameStarting = false;
        let isGamePlaying = false;
        let currentPattern = []; // í˜„ì¬ ê²Œì„ íŒ¨í„´ ì €ì¥
        let roundCount = 0; // ë¼ìš´ë“œ ì¹´ìš´í„°
        let currentBoxIndex = -1; // í˜„ì¬ ê°•ì¡°ëœ ë°•ìŠ¤ ì¸ë±ìŠ¤
        let inputReceived = false; // í˜„ì¬ ë°•ìŠ¤ì—ì„œ ì…ë ¥ì„ ë°›ì•˜ëŠ”ì§€

        // interval ì €ì¥ ë³€ìˆ˜ë“¤
        let wordInterval = null;
        let highlightInterval = null;
        let allTimeouts = []; // setTimeout ID ì €ì¥

        // ë‹¨ì–´ë³„ ì •ë‹µ í‚¤ ì •ì˜
        const upWords = ['ì§œì‡í˜¸í•´', 'ì…ì¥í•´', 'ë“¤ì–´ê°€', 'ì•„ë¬´ê±°ë‚˜í•´'];
        const downWords = ['ë‚³ì•„', 'í‡´ì¥í•´', 'ì•„ë¬´ê±°ë‚˜í•´', 'í˜¸ì‡ì§œí•´'];
        const noInputWords = ['ê³ ë•ì´ˆ', 'ë‚³ì§€ë§ˆ', 'ë“¤ì–´ê°€ì§€ë§ˆ', '-'];

        // ëª¨ë“  intervalê³¼ timeout ì •ë¦¬ í•¨ìˆ˜
        function clearAllIntervals() {
            if(wordInterval) {
                clearInterval(wordInterval);
                wordInterval = null;
            }
            if(highlightInterval) {
                clearInterval(highlightInterval);
                highlightInterval = null;
            }
            // ëª¨ë“  timeout ì •ë¦¬
            allTimeouts.forEach(id => clearTimeout(id));
            allTimeouts = [];
        }

        // ê²Œì„ ì˜¤ë²„ ì²˜ë¦¬ í•¨ìˆ˜
        function gameOver() {
            isGamePlaying = false;

            // ëª¨ë“  interval ì •ë¦¬
            clearAllIntervals();

            // ê²Œì„ ìŒì•… ì •ì§€
            inGameMusic.pause();

            // ê²Œì„ ì˜¤ë²„ ì˜¤ë²„ë ˆì´ í‘œì‹œ
            document.getElementById('gameOverOverlay').classList.add('active');
        }

        // ì •ë‹µ ì²´í¬ í•¨ìˆ˜
        function checkAnswer(input) {
            if(currentBoxIndex < 0 || currentBoxIndex >= 4) return;
            if(inputReceived) return; // ì´ë¯¸ ì…ë ¥ë°›ì•˜ìœ¼ë©´ ë¬´ì‹œ

            const word = currentPattern[currentBoxIndex];
            let isCorrect = false;

            if(input === 'up') {
                isCorrect = upWords.includes(word);
            } else if(input === 'down') {
                isCorrect = downWords.includes(word);
            }

            if(isCorrect) {
                console.log('ì •ë‹µ!');
                inputReceived = true;
            } else {
                console.log('ì˜¤ë‹µ!');
                inputReceived = true;
                gameOver();
            }
        }

        // ëœë¤ íŒ¨í„´ ìƒì„±
        function generatePattern() {
            roundCount++;
            updateBackgroundColor(); // ë°°ê²½ìƒ‰ ì—…ë°ì´íŠ¸
            const pattern = ['-', '-', '-', '-'];

            // ì²« ë²ˆì§¸ëŠ” ë¬´ì¡°ê±´ "ê³ ë•ì´ˆ"
            pattern[0] = 'ê³ ë•ì´ˆ';

            // ë¼ìš´ë“œì— ë”°ë¼ ì‚¬ìš©í•  ë‹¨ì–´ ê²°ì •
            let availableWords = [];
            let wordCount = 1;

            if(roundCount <= 2) {
                // 1-2ë²ˆì§¸: ì‰¬ì›€
                availableWords = ['ë‚³ì•„', 'ë“¤ì–´ê°€'];
                wordCount = Math.floor(Math.random() * 3) + 1; // 1~3ê°œ
            } else if(roundCount <= 6) {
                // 3-6ë²ˆì§¸: ì¤‘ê°„
                availableWords = ['ë‚³ì•„', 'ë“¤ì–´ê°€', 'ë‚³ì§€ë§ˆ', 'ë“¤ì–´ê°€ì§€ë§ˆ'];
                wordCount = Math.floor(Math.random() * 3) + 1; // 1~3ê°œ
            } else if(roundCount <= 9) {
                // 7-9ë²ˆì§¸: ì–´ë ¤ì›€
                availableWords = ['ë‚³ì•„', 'ë“¤ì–´ê°€', 'ë‚³ì§€ë§ˆ', 'ë“¤ì–´ê°€ì§€ë§ˆ', 'í˜¸ì‡ì§œí•´', 'ì§œì‡í˜¸í•´', 'ì•„ë¬´ê±°ë‚˜í•´', 'ì…ì¥í•´', 'í‡´ì¥í•´'];
                wordCount = Math.floor(Math.random() * 3) + 1; // 1~3ê°œ
            } else {
                // 10ë²ˆì§¸ ì´ìƒ: ë§¤ìš° ì–´ë ¤ì›€
                availableWords = ['í˜¸ì‡ì§œí•´', 'ì§œì‡í˜¸í•´', 'ì•„ë¬´ê±°ë‚˜í•´', 'ì…ì¥í•´', 'í‡´ì¥í•´', 'ë‚³ì•„', 'ë‚³ì§€ë§ˆ', 'ë“¤ì–´ê°€', 'ë“¤ì–´ê°€ì§€ë§ˆ'];
                wordCount = 3; // ë¬´ì¡°ê±´ 3ê°œ
            }

            // 2, 3, 4ë²ˆì§¸ ìœ„ì¹˜ì— ëœë¤í•˜ê²Œ ë‹¨ì–´ ë°°ì¹˜
            const availablePositions = [1, 2, 3];

            for(let i = 0; i < wordCount && availablePositions.length > 0; i++) {
                // ëœë¤ ìœ„ì¹˜ ì„ íƒ
                const posIndex = Math.floor(Math.random() * availablePositions.length);
                const position = availablePositions[posIndex];

                // ëœë¤ ë‹¨ì–´ ì„ íƒ
                const word = availableWords[Math.floor(Math.random() * availableWords.length)];
                pattern[position] = word;

                // ì‚¬ìš©í•œ ìœ„ì¹˜ ì œê±°
                availablePositions.splice(posIndex, 1);
            }

            return pattern;
        }

        // íŒ¨í„´ì„ í™”ë©´ì— í‘œì‹œ
        function displayPattern(pattern) {
            document.getElementById('word1').textContent = pattern[0];
            document.getElementById('word2').textContent = pattern[1];
            document.getElementById('word3').textContent = pattern[2];
            document.getElementById('word4').textContent = pattern[3];
            currentPattern = pattern;
        }

        // ë°°ê²½ìƒ‰ ì—…ë°ì´íŠ¸
        function updateBackgroundColor() {
            if(roundCount <= 2) {
                // 1ë‹¨ê³„: ì—°í•œ íŒŒë€ìƒ‰
                document.body.style.backgroundColor = '#ADD8E6';
            } else if(roundCount <= 6) {
                // 2ë‹¨ê³„: ì—°í•œ ë³´ë¼ìƒ‰
                document.body.style.backgroundColor = '#E6D5FF';
            } else if(roundCount <= 9) {
                // 3ë‹¨ê³„: ì—°í•œ ë¶„í™ìƒ‰
                document.body.style.backgroundColor = '#FFD5E5';
            } else {
                // 4ë‹¨ê³„: ì—°í•œ ë¹¨ê°„ìƒ‰ (ë§¤ìš° ì–´ë ¤ì›€)
                document.body.style.backgroundColor = '#FFB8B8';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŒì•… ì¬ìƒ ì‹œë„
        window.addEventListener('load', function() {
            bgMusic.play().catch(function(error) {
                console.log('ìë™ ì¬ìƒ ì‹¤íŒ¨, ì‚¬ìš©ì ì¸í„°ë™ì…˜ í•„ìš”');
            });
        });

        // ì‚¬ìš©ìê°€ í™”ë©´ì„ í´ë¦­í•˜ë©´ ìŒì•… ì¬ìƒ (ë©”ì¸ í™”ë©´ì—ì„œë§Œ)
        document.body.addEventListener('click', function() {
            if(bgMusic.paused && !isGameStarting) {
                bgMusic.play();
            }
        }, { once: true });

        // í™”ì‚´í‘œ ì•„ì´ì½˜ í‘œì‹œ í•¨ìˆ˜
        function showArrowIcon(direction) {
            if(currentBoxIndex < 0 || currentBoxIndex >= 4) return;

            const boxes = document.querySelectorAll('.game-box');
            const currentBox = boxes[currentBoxIndex];
            const arrowIcon = currentBox.querySelector('.arrow-icon');

            // ë°©í–¥ í´ë˜ìŠ¤ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€
            arrowIcon.classList.remove('up', 'down');
            arrowIcon.classList.add(direction);

            // ì•„ì´ì½˜ í‘œì‹œ
            arrowIcon.classList.add('show');

            // ì•„ê¸° ì´ë¯¸ì§€ ì• ë‹ˆë©”ì´ì…˜
            const babyImage = document.getElementById('babyImage');
            babyImage.classList.remove('fall', 'rise');
            babyImage.classList.add('show');

            if(direction === 'down') {
                babyImage.classList.add('fall');
            } else if(direction === 'up') {
                babyImage.classList.add('rise');
            }

            // ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚˜ë©´ ì•„ê¸° ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸°
            babyImage.addEventListener('animationend', function hideBaby() {
                babyImage.classList.remove('show', 'fall', 'rise');
                babyImage.removeEventListener('animationend', hideBaby);
            });
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('keydown', function(e) {
            if(!isGamePlaying) return;

            // ê°•ì¡°ëœ ë°•ìŠ¤ê°€ ìˆëŠ”ì§€ í™•ì¸
            const activeBox = document.querySelector('.game-box.active');
            if(!activeBox) return;

            if(e.key === 'ArrowDown') {
                // ì•„ë˜ í™”ì‚´í‘œ - ho.mp3 ì¬ìƒ
                hoSound.currentTime = 0;
                hoSound.play();
                showArrowIcon('down');
                checkAnswer('down');
            } else if(e.key === 'ArrowUp') {
                // ìœ„ í™”ì‚´í‘œ - jja.mp3 ì¬ìƒ
                jjaSound.currentTime = 0;
                jjaSound.play();
                showArrowIcon('up');
                checkAnswer('up');
            }
        });

        document.getElementById('startGame').addEventListener('click', function(e) {
            // ê¸°ì¡´ interval ëª¨ë‘ ì •ë¦¬
            clearAllIntervals();

            // ê²Œì„ ì‹œì‘ í”Œë˜ê·¸ ì„¤ì •
            isGameStarting = true;

            // ë¼ìš´ë“œ ì¹´ìš´í„° ë¦¬ì…‹
            roundCount = 0;
            currentBoxIndex = -1;
            inputReceived = false;

            // ë‹¨ì–´ ë¦¬ì…‹
            document.getElementById('word1').textContent = '-';
            document.getElementById('word2').textContent = '-';
            document.getElementById('word3').textContent = '-';
            document.getElementById('word4').textContent = '-';

            // ë°•ìŠ¤ ê°•ì¡° ì œê±° ë° ì•„ì´ì½˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.game-box').forEach(box => {
                box.classList.remove('active');
                const icon = box.querySelector('.arrow-icon');
                icon.classList.remove('show', 'up', 'down');
            });

            // ì•„ê¸° ì´ë¯¸ì§€ ì´ˆê¸°í™”
            const babyImage = document.getElementById('babyImage');
            babyImage.classList.remove('show', 'fall', 'rise');

            // ë°°ê²½ìƒ‰ ë¦¬ì…‹
            document.body.style.backgroundColor = '#ADD8E6';

            // ë©”ì¸ ìŒì•… ì™„ì „íˆ ì •ì§€
            bgMusic.pause();
            bgMusic.currentTime = 0;

            // ë©”ì¸ í™”ë©´ ìˆ¨ê¸°ê¸°
            document.getElementById('mainScreen').style.display = 'none';

            // ê²Œì„ í™”ë©´ ë¨¼ì € í‘œì‹œ
            document.getElementById('gameScreen').classList.add('active');

            // ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘ (ìŒì•… êº¼ì§„ ìƒíƒœ)
            startCountdown();
        });

        function startCountdown() {
            const countdownOverlay = document.getElementById('countdownOverlay');
            const countdownNumber = document.getElementById('countdownNumber');

            // ë©”ì¸ ìŒì•… ì •ì§€
            bgMusic.pause();

            // ê²Œì„ ìŒì•… ì‹œì‘
            inGameMusic.currentTime = 0;
            inGameMusic.play();

            // ì¹´ìš´íŠ¸ë‹¤ìš´ ì˜¤ë²„ë ˆì´ í‘œì‹œ
            countdownOverlay.classList.add('active');

            let count = 3;
            countdownNumber.textContent = count;

            const countdownInterval = setInterval(function() {
                count--;

                if(count > 0) {
                    // ì• ë‹ˆë©”ì´ì…˜ ì¬ì‹¤í–‰ì„ ìœ„í•´ ìš”ì†Œ ì œê±° í›„ ë‹¤ì‹œ ì¶”ê°€
                    countdownNumber.style.animation = 'none';
                    setTimeout(function() {
                        countdownNumber.style.animation = '';
                        countdownNumber.textContent = count;
                    }, 10);
                } else if(count === 0) {
                    // "ì‹œì‘!" í‘œì‹œ
                    countdownNumber.style.animation = 'none';
                    setTimeout(function() {
                        countdownNumber.style.animation = '';
                        countdownNumber.textContent = 'ì‹œì‘!';
                    }, 10);
                } else {
                    clearInterval(countdownInterval);

                    // ì¹´ìš´íŠ¸ë‹¤ìš´ ì˜¤ë²„ë ˆì´ ìˆ¨ê¸°ê¸°
                    countdownOverlay.classList.remove('active');

                    // ì¹´ìš´íŠ¸ë‹¤ìš´ ìŒì•… ì •ì§€
                    inGameMusic.pause();
                    inGameMusic.currentTime = 0;

                    // ë©”ì¸ ìŒì•… ì¬ìƒ
                    bgMusic.currentTime = 0;
                    bgMusic.play();

                    // ê²Œì„ ì‹œì‘
                    isGamePlaying = true;
                    startBoxHighlight();
                }
            }, 390);
        }

        function startBoxHighlight() {
            const boxes = document.querySelectorAll('.game-box');

            function showWordsAndHighlight() {
                // ê²Œì„ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
                if(!isGamePlaying) return;

                // ê¸°ì¡´ interval ì •ë¦¬ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€)
                if(wordInterval) {
                    clearInterval(wordInterval);
                    wordInterval = null;
                }
                if(highlightInterval) {
                    clearInterval(highlightInterval);
                    highlightInterval = null;
                }

                // ìƒˆ íŒ¨í„´ ìƒì„±
                const pattern = generatePattern();
                currentPattern = pattern;

                // ì²« ë²ˆì§¸ ë‹¨ì–´ë¥¼ ì¦‰ì‹œ í‘œì‹œ
                document.getElementById('word1').textContent = pattern[0];

                // ë‚˜ë¨¸ì§€ ë‹¨ì–´ë“¤ì„ 390ms ê°„ê²©ìœ¼ë¡œ ìˆœì„œëŒ€ë¡œ í‘œì‹œ
                let wordIndex = 1;
                wordInterval = setInterval(function() {
                    // ê²Œì„ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©´ interval ì •ë¦¬
                    if(!isGamePlaying) {
                        clearInterval(wordInterval);
                        wordInterval = null;
                        return;
                    }

                    if(wordIndex >= 4) {
                        clearInterval(wordInterval);
                        wordInterval = null;
                        return;
                    }

                    // í˜„ì¬ ë‹¨ì–´ í‘œì‹œ
                    document.getElementById('word' + (wordIndex + 1)).textContent = pattern[wordIndex];
                    wordIndex++;
                }, 390);

                // 1ì´ˆ í›„ ë°•ìŠ¤ ê°•ì¡° ì‹œì‘
                const timeoutId = setTimeout(function() {
                    // ê²Œì„ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
                    if(!isGamePlaying) return;
                    startBoxAnimation();
                }, 1000);
                allTimeouts.push(timeoutId);

                function startBoxAnimation() {
                    let currentBox = 0;

                    // ë°•ìŠ¤ë¥¼ ì°¨ë¡€ëŒ€ë¡œ ê°•ì¡°
                    highlightInterval = setInterval(function() {
                        // ê²Œì„ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©´ interval ì •ë¦¬
                        if(!isGamePlaying) {
                            clearInterval(highlightInterval);
                            highlightInterval = null;
                            return;
                        }

                        // ëª¨ë“  ë°•ìŠ¤ ë‹¤ ê°•ì¡°í–ˆìœ¼ë©´
                        if(currentBox >= 4) {
                            clearInterval(highlightInterval);
                            highlightInterval = null;
                            // ëª¨ë“  ë°•ìŠ¤ ê°•ì¡° í•´ì œ ë° ì•„ì´ì½˜ ìˆ¨ê¸°ê¸°
                            boxes.forEach(box => {
                                box.classList.remove('active');
                                const icon = box.querySelector('.arrow-icon');
                                icon.classList.remove('show', 'up', 'down');
                            });

                            // ëª¨ë“  ë‹¨ì–´ ë¦¬ì…‹
                            document.getElementById('word1').textContent = '-';
                            document.getElementById('word2').textContent = '-';
                            document.getElementById('word3').textContent = '-';
                            document.getElementById('word4').textContent = '-';

                            // ë‹¤ì‹œ ë‹¨ì–´ í‘œì‹œ ë° ê°•ì¡° ì‹œì‘
                            showWordsAndHighlight();
                            return;
                        }

                        // ëª¨ë“  ë°•ìŠ¤ì—ì„œ active ì œê±° ë° ì•„ì´ì½˜ ìˆ¨ê¸°ê¸°
                        boxes.forEach(box => {
                            box.classList.remove('active');
                            const icon = box.querySelector('.arrow-icon');
                            icon.classList.remove('show');
                        });

                        // í˜„ì¬ ë°•ìŠ¤ ê°•ì¡°
                        boxes[currentBox].classList.add('active');

                        // í˜„ì¬ ë°•ìŠ¤ ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸ ë° ì…ë ¥ í”Œë˜ê·¸ ë¦¬ì…‹
                        currentBoxIndex = currentBox;
                        inputReceived = false;

                        // í˜„ì¬ ë‹¨ì–´ í™•ì¸
                        const word = currentPattern[currentBox];

                        // ì…ë ¥ ì²´í¬
                        const timeoutId = setTimeout(function() {
                            // ê²Œì„ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
                            if(!isGamePlaying) return;

                            let isCorrectAnswer = false;

                            if(noInputWords.includes(word)) {
                                // ì…ë ¥í•˜ë©´ ì•ˆ ë˜ëŠ” ë‹¨ì–´
                                if(!inputReceived) {
                                    console.log('ì •ë‹µ! (ì…ë ¥ ì—†ìŒ)');
                                    isCorrectAnswer = true;
                                } else {
                                    console.log('ì˜¤ë‹µ! (ì…ë ¥í•˜ë©´ ì•ˆë¨)');
                                    gameOver();
                                }
                            } else {
                                // ì…ë ¥í•´ì•¼ í•˜ëŠ” ë‹¨ì–´ (upWords ë˜ëŠ” downWords)
                                if(inputReceived) {
                                    console.log('ì •ë‹µ! (ì…ë ¥í•¨)');
                                    isCorrectAnswer = true;
                                } else {
                                    console.log('ì˜¤ë‹µ! (ì…ë ¥ ì•ˆí•¨)');
                                    gameOver();
                                }
                            }

                            // 4ë²ˆì§¸ ë°•ìŠ¤ì—ì„œ ì •ë‹µì´ë©´ O í‘œì‹œ (ì•½ê°„ì˜ ë”œë ˆì´ í›„)
                            if(isCorrectAnswer && currentBoxIndex === 3) {
                                const showOkayTimeout = setTimeout(function() {
                                    const okaySign = document.getElementById('okaySign');
                                    okaySign.classList.remove('hide');
                                    okaySign.classList.add('show');
                                    okaySound.currentTime = 0;
                                    okaySound.play();

                                    // 1.2ì´ˆ í›„ O í‘œì‹œ ìˆ¨ê¸°ê¸°
                                    const hideTimeout = setTimeout(function() {
                                        okaySign.classList.remove('show');
                                        okaySign.classList.add('hide');
                                    }, 1200);
                                    allTimeouts.push(hideTimeout);
                                }, 100);
                                allTimeouts.push(showOkayTimeout);
                            }
                        }, 250);
                        allTimeouts.push(timeoutId);

                        currentBox++;
                    }, 390);
                }
            }

            // ì²« ì‚¬ì´í´ ì‹œì‘
            showWordsAndHighlight();
        }

        // ê²Œì„ ë°©ë²• íŒì—… ì œì–´
        let currentPopupPage = 1;
        const totalPopupPages = 5;

        function updatePopupPage() {
            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.popup-page').forEach(page => {
                page.classList.remove('active');
            });

            // í˜„ì¬ í˜ì´ì§€ í‘œì‹œ
            document.querySelector(`.popup-page[data-page="${currentPopupPage}"]`).classList.add('active');

            // í˜ì´ì§€ ë²ˆí˜¸ ì—…ë°ì´íŠ¸
            document.getElementById('currentPage').textContent = currentPopupPage;

            // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
            document.getElementById('prevPage').disabled = (currentPopupPage === 1);
            document.getElementById('nextPage').disabled = (currentPopupPage === totalPopupPages);
        }

        // ê²Œì„ ë°©ë²• ë²„íŠ¼
        document.getElementById('howToPlay').addEventListener('click', function() {
            currentPopupPage = 1;
            updatePopupPage();
            document.getElementById('howToPlayPopup').classList.add('active');
        });

        // íŒì—… ë‹«ê¸°
        document.getElementById('closePopup').addEventListener('click', function() {
            document.getElementById('howToPlayPopup').classList.remove('active');
        });

        // ì´ì „ í˜ì´ì§€
        document.getElementById('prevPage').addEventListener('click', function() {
            if(currentPopupPage > 1) {
                currentPopupPage--;
                updatePopupPage();
            }
        });

        // ë‹¤ìŒ í˜ì´ì§€
        document.getElementById('nextPage').addEventListener('click', function() {
            if(currentPopupPage < totalPopupPages) {
                currentPopupPage++;
                updatePopupPage();
            }
        });

        // íŒì—… ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('howToPlayPopup').addEventListener('click', function(e) {
            if(e.target === this) {
                this.classList.remove('active');
            }
        });

        // í™”ì‚´í‘œ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('upBtn').addEventListener('click', function() {
            if(!isGamePlaying) return;

            // ê°•ì¡°ëœ ë°•ìŠ¤ê°€ ìˆëŠ”ì§€ í™•ì¸
            const activeBox = document.querySelector('.game-box.active');
            if(!activeBox) return;

            // ìœ„ í™”ì‚´í‘œ - jja.mp3 ì¬ìƒ
            jjaSound.currentTime = 0;
            jjaSound.play();
            showArrowIcon('up');
            checkAnswer('up');
        });

        document.getElementById('downBtn').addEventListener('click', function() {
            if(!isGamePlaying) return;

            // ê°•ì¡°ëœ ë°•ìŠ¤ê°€ ìˆëŠ”ì§€ í™•ì¸
            const activeBox = document.querySelector('.game-box.active');
            if(!activeBox) return;

            // ì•„ë˜ í™”ì‚´í‘œ - ho.mp3 ì¬ìƒ
            hoSound.currentTime = 0;
            hoSound.play();
            showArrowIcon('down');
            checkAnswer('down');
        });

        // ë‹¤ì‹œ ì‹œì‘ í•¨ìˆ˜
        function restartGame() {
            // ëª¨ë“  interval ì •ë¦¬
            clearAllIntervals();

            // ê²Œì„ ì˜¤ë²„ ì˜¤ë²„ë ˆì´ ìˆ¨ê¸°ê¸°
            document.getElementById('gameOverOverlay').classList.remove('active');

            // ë¼ìš´ë“œ ì¹´ìš´í„° ë¦¬ì…‹
            roundCount = 0;
            currentBoxIndex = -1;
            inputReceived = false;

            // ë‹¨ì–´ ë¦¬ì…‹
            document.getElementById('word1').textContent = '-';
            document.getElementById('word2').textContent = '-';
            document.getElementById('word3').textContent = '-';
            document.getElementById('word4').textContent = '-';

            // ë°•ìŠ¤ ê°•ì¡° ì œê±° ë° ì•„ì´ì½˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.game-box').forEach(box => {
                box.classList.remove('active');
                const icon = box.querySelector('.arrow-icon');
                icon.classList.remove('show', 'up', 'down');
            });

            // ì•„ê¸° ì´ë¯¸ì§€ ì´ˆê¸°í™”
            const babyImage = document.getElementById('babyImage');
            babyImage.classList.remove('show', 'fall', 'rise');

            // ë°°ê²½ìƒ‰ ë¦¬ì…‹
            document.body.style.backgroundColor = '#ADD8E6';

            // ê²Œì„ ìŒì•… ì´ˆê¸°í™”
            inGameMusic.pause();
            inGameMusic.currentTime = 0;

            // ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
            isGameStarting = true;
            startCountdown();
        }

        // ë©”ì¸ ë©”ë‰´ë¡œ ê°€ëŠ” í•¨ìˆ˜
        function goToMainMenu() {
            // ëª¨ë“  interval ì •ë¦¬
            clearAllIntervals();

            // ê²Œì„ ì˜¤ë²„ ì˜¤ë²„ë ˆì´ ìˆ¨ê¸°ê¸°
            document.getElementById('gameOverOverlay').classList.remove('active');

            // ê²Œì„ í™”ë©´ ìˆ¨ê¸°ê¸°
            document.getElementById('gameScreen').classList.remove('active');

            // ë©”ì¸ í™”ë©´ í‘œì‹œ
            document.getElementById('mainScreen').style.display = 'block';

            // ë°•ìŠ¤ ì•„ì´ì½˜ ëª¨ë‘ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.game-box').forEach(box => {
                const icon = box.querySelector('.arrow-icon');
                icon.classList.remove('show', 'up', 'down');
            });

            // ì•„ê¸° ì´ë¯¸ì§€ ì´ˆê¸°í™”
            const babyImage = document.getElementById('babyImage');
            babyImage.classList.remove('show', 'fall', 'rise');

            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            isGameStarting = false;
            isGamePlaying = false;
            roundCount = 0;
            currentBoxIndex = -1;
            inputReceived = false;

            // ë°°ê²½ìƒ‰ ë¦¬ì…‹
            document.body.style.backgroundColor = '#ADD8E6';

            // ê²Œì„ ìŒì•… ì •ì§€
            inGameMusic.pause();
            inGameMusic.currentTime = 0;

            // ë©”ì¸ ìŒì•… ì²˜ìŒë¶€í„° ì¬ìƒ
            bgMusic.currentTime = 0;
            bgMusic.play();
        }

        // ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('restartGame').addEventListener('click', restartGame);

        // ë©”ì¸ ë©”ë‰´ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('backToMenu').addEventListener('click', goToMainMenu);

        // ê²Œì„ ì˜¤ë²„ í™”ë©´ í‚¤ë³´ë“œ ì´ë²¤íŠ¸
        document.addEventListener('keydown', function(e) {
            // ê²Œì„ ì˜¤ë²„ í™”ë©´ì´ í™œì„±í™”ë˜ì–´ ìˆì„ ë•Œë§Œ
            const gameOverOverlay = document.getElementById('gameOverOverlay');
            if(!gameOverOverlay.classList.contains('active')) return;

            if(e.key === 'r' || e.key === 'R') {
                restartGame();
            } else if(e.key === 'm' || e.key === 'M') {
                goToMainMenu();
            }
        });
    </script>
</body>
</html>
